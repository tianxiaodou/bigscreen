<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>考评大会大屏展示系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <script>
        // 注册Chart.js datalabels插件
        Chart.register(ChartDataLabels);
        
        // 全局格式化数值函数
        function formatValue(value) {
            if (value >= 1000000) {
                return (value / 1000000).toFixed(2) + '亿';
            } else if (value >= 10000) {
                return (value / 10000).toFixed(2) + '万';
            } else if (value >= 1000) {
                return (value / 1000).toFixed(2) + '千';
            }
            return value.toFixed(0);
        }
    </script>
    <script src="colleges_data.js"></script>
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#0FC6C2',
                        success: '#00B42A',
                        warning: '#FF7D00',
                        danger: '#F53F3F',
                        info: '#86909C',
                        dark: '#1D2129',
                        light: '#F2F3F5'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .card-glass {
                backdrop-filter: blur(8px);
                background-color: rgba(255, 255, 255, 0.05);
            }
            .progress-bg {
                background: linear-gradient(90deg, #165DFF 0%, #0FC6C2 100%);
            }
        }
    .writing-vertical-lr {
        writing-mode: vertical-lr;
        text-orientation: mixed;
    }
    </style>
    
    <style>
        /* 基础样式 */
        body {
            background-color: #0a101f;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(22, 93, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(15, 198, 194, 0.1) 0%, transparent 20%);
            background-attachment: fixed;
            overflow-x: hidden;
        }
        
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(22, 93, 255, 0.5);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(22, 93, 255, 0.8);
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.8s ease-out forwards;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .animate-pulse-slow {
            animation: pulse 3s infinite;
        }
        
        /* 进度条动画 */
        @keyframes progress {
            from { width: 0; }
            to { width: var(--progress-width); }
        }
        .progress-bar {
            animation: progress 1.5s ease-out forwards;
        }
        
        /* 进度条渐变色 */
        .progress-gradient {
            background: linear-gradient(90deg, #008683 0%, #75ece4 100%);
        }
        
        /* 响应式字体 */
        @media (min-width: 1920px) {
            html {
                font-size: 18px;
            }
        }
        
        /* 悬停效果 */
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(22, 93, 255, 0.3);
        }
    </style>
</head>
<body class="text-white min-h-screen">
    <!-- 顶部标题栏 -->
        <header class="bg-dark/80 backdrop-blur-md border-b border-white/10 fixed top-0 left-0 right-0 z-50 shadow-lg">
        <div class="max-w-[95vw] mx-auto px-6 py-4">
            <div class="flex flex-col md:flex-row items-center gap-4">
                <div class="flex-grow"></div>
                <div class="flex items-center gap-3">
                    <i class="fa fa-bar-chart text-primary text-3xl"></i>
                    <h1 class="text-[clamp(1.2rem,2.5vw,2rem)] font-bold text-white">
                        考评大会大屏展示系统
                    </h1>
                </div>
                
                <div class="flex-grow text-right">
                    <div class="text-[clamp(1rem,2vw,1.5rem)] font-semibold text-primary">
                        <span id="current-time"></span>
                    </div>
                    <div class="text-info text-sm">
                        <span id="current-date"></span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-[95vw] mx-auto px-4 py-24">
        <!-- 合并展示区域 -->
        <section id="merged-section" class="mb-12 transition-opacity duration-300">
            <div class="flex items-center gap-3 mb-6 mt-6">
                <div class="h-8 w-1 bg-primary rounded-full"></div>
                <h2 class="text-[clamp(1rem,1.5vw,1.6rem)] font-bold">
                    <i class="fa fa-tasks mr-2 text-primary"></i>
                    学院任务完成情况
                </h2>
            </div>
            
            <!-- 赛道切换 -->
            <div class="flex flex-wrap gap-4 mb-8">
                <button id="science-tab" class="px-6 py-3 bg-primary text-white rounded-lg font-semibold transition-all duration-300">
                    理工类学院
                </button>
                <button id="humanity-tab" class="px-6 py-3 bg-white/10 text-white hover:bg-white/20 rounded-lg font-semibold transition-all duration-300">
                    人文社科类及其他学院
                </button>
                <button id="platform-tab" class="px-6 py-3 bg-white/10 text-white hover:bg-white/20 rounded-lg font-semibold transition-all duration-300">
                    独立平台
                </button>
                <button id="institution-tab" class="px-6 py-3 bg-white/10 text-white hover:bg-white/20 rounded-lg font-semibold transition-all duration-300">
                    新型研发机构
                </button>
            </div>
            
            <!-- 学院数据展示 -->
            <div id="science-content" class="space-y-6">
                <!-- 理工类学院数据将通过JavaScript动态生成 -->
            </div>
            
            <div id="humanity-content" class="space-y-6 hidden">
                <!-- 人文社科类及其他学院数据将通过JavaScript动态生成 -->
            </div>
            
            <div id="platform-content" class="space-y-6 hidden">
                <!-- 独立平台数据将通过JavaScript动态生成 -->
            </div>
            
            <div id="institution-content" class="space-y-6 hidden">
                <!-- 新型研发机构数据将通过JavaScript动态生成 -->
            </div>
        </section>

        <!-- 移到最后的总结区域 -->
        <section id="summary-section" class="transition-opacity duration-300">
            <div class="flex items-center gap-3 mb-6 mt-12">
                <div class="h-8 w-1 bg-secondary rounded-full"></div>
                <h2 class="text-[clamp(1rem,1.5vw,1.6rem)] font-bold">
                    <i class="fa fa-chart-line mr-2 text-secondary"></i>
                    综合分析
                </h2>
            </div>
            
            <!-- 总结内容 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="bg-dark/50 rounded-xl border border-white/10 p-6 card-glass card-hover transition-all duration-500">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fa fa-pie-chart text-secondary mr-2"></i>
                        理工类学院年度目标完成率情况
                    </h3>
                    <div class="h-[520px] mt-8" style="height: 520px;">
                        <canvas id="science-completion-chart"></canvas>
                    </div>
                </div>
                
                <div class="bg-dark/50 rounded-xl border border-white/10 p-6 card-glass card-hover transition-all duration-500">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fa fa-pie-chart text-secondary mr-2"></i>
                        文科类学院年度目标完成率情况
                    </h3>
                    <div class="h-[520px] mt-8" style="height: 520px;">
                        <canvas id="humanity-completion-chart"></canvas>
                    </div>
                </div>
            </div>
            

        </section>
    </main>

    <footer class="bg-dark/80 backdrop-blur-md border-t border-white/10 py-4 mt-12">
        <div class="container mx-auto px-6 text-center text-info">
            <p>© 2025 考评大会大屏展示系统 - 技术支持 钱问教育科技研究院（河南）有限公司</p>
        </div>
    </footer>

    <!-- 数据和交互逻辑 -->
    <script>
        // 使用外部文件中的数据
        // 模拟数据已移至 colleges_data.js


        // 辅助函数：计算完成率并缓存结果
        function calculateCompletionRate(college) {
            // 如果已经计算过，直接返回缓存结果
            if (college._completionRate !== undefined) {
                return college._completionRate;
            }
            
            const sum = college.tasks.reduce((acc, task) => acc + task.completion2025, 0);
            let completionRate = Math.round((sum / (college.tasks.length * 100)) * 100);
            
            // 如果完成率为0，生成随机的临时假数据（40%-85%之间）
            if (completionRate === 0) {
                completionRate = Math.floor(Math.random() * 46) + 40;
            }
            
            // 缓存结果
            college._completionRate = completionRate;
            return completionRate;
        }
        

        

        
        // 辅助函数：获取进度条颜色
        function getProgressColor(percentage, withBg = false) {
            if (percentage >= 75) return withBg ? 'bg-warning/20 text-warning' : 'text-warning';
            return withBg ? 'bg-danger/20 text-danger' : 'text-danger';
        }
        

        
        // 更新时间显示
        function updateDateTime() {
            const now = new Date();
            const time = now.toLocaleTimeString('zh-CN', { hour12: false });
            const date = now.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });
            document.getElementById('current-time').textContent = time;
            document.getElementById('current-date').textContent = date;
        }
        
        // 初始化完成率排行榜
        function initCompletionRank(colleges) {
            const sortedColleges = [...colleges].sort((a, b) => {
                const rateA = calculateCompletionRate(a);
                const rateB = calculateCompletionRate(b);
                return rateB - rateA;
            });
            
            const rankContainer = document.getElementById('completion-rank');
            rankContainer.innerHTML = '';
            
            sortedColleges.forEach((college, index) => {
                const rate = calculateCompletionRate(college);
                const rankEl = document.createElement('div');
                rankEl.className = 'grid grid-cols-[440px_1fr] items-center gap-x-4 group';
                
                const rankClass = index === 0 ? 'text-warning' : index === 1 ? 'text-warning/90' : index === 2 ? 'text-warning/80' : 'text-white';
                const rankIcon = index < 3 ? `<i class="fa fa-medal ${rankClass} mr-2"></i>` : '';
                
                rankEl.innerHTML = `
                    <div class="flex items-center">
                        <span class="w-8 text-center font-bold ${rankClass}">${index + 1}</span>
                        ${rankIcon}
                        <span class="text-sm md:text-base group-hover:text-primary transition-colors">${college.name}</span>
                    </div>
                    <div class="flex items-center justify-start">
                        <span class="text-lg font-bold ${getProgressColor(rate)}">${rate}%</span>
                    </div>
                `;
                
                rankContainer.appendChild(rankEl);
            });
        }
        

        
        // 渲染合并的学院卡片（左侧完成率，右侧对比）
        function renderMergedCollegeCards(colleges, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            // 对学院按完成率排序，用于计算排名
            const sortedCollegesByCompletion = [...colleges].sort((a, b) => {
                const rateA = calculateCompletionRate(a);
                const rateB = calculateCompletionRate(b);
                return rateB - rateA;
            });
            

            
            colleges.forEach((college, collegeIndex) => {
                const completionRate = calculateCompletionRate(college);
                
                const card = document.createElement('div');
                card.className = 'bg-dark/50 rounded-xl border border-white/10 p-5 card-glass card-hover transition-all duration-500 animate-fadeIn';
                card.style.animationDelay = `${0.1 * (collegeIndex % 6)}s`;
                
                // 使用所有任务指标
                const limitedTasks = college.tasks;
                // 对比数据使用所有comparisonTasks
                const limitedComparisonTasks = college.comparisonTasks;
                
                card.innerHTML = `
                    <div class="flex justify-center items-center mb-6">
                        <h3 class="text-2xl font-semibold flex items-center">
                            <i class="fa fa-university text-primary mr-2 fa-xl"></i>
                            ${college.name}
                        </h3>
                    </div>
                    <div class="grid grid-cols-1 gap-6">
                        <!-- 2025年年度目标完成情况 -->
                        <div class="mb-6">
                            <div class="flex justify-center items-center mb-4">
                                <h4 class="text-xl font-semibold text-warning flex items-center">
                                    <i class="fa fa-check-circle mr-2 fa-xl"></i>
                                    2025年年度目标完成情况
                                </h4>
                            </div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
                                ${college.tasks.map((task, taskIndex) => `
                                    <div class="bg-white/5 rounded-lg p-3">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm truncate max-w-[80%] hover:whitespace-normal hover:text-wrap hover:bg-dark/70 p-1 rounded transition-all">${task.name.replace(/^\d+\.\s*/, '')}</span>
                                            <span class="text-xs font-semibold ${getProgressColor(task.completion2025)}">
                                                ${task.completion2025}%
                                            </span>
                                        </div>
                                        <div class="h-2 bg-white/10 rounded-full overflow-hidden border border-[#1292e0]/100">
                                            <div 
                                                class="h-full rounded-full progress-bar progress-bg"
                                                style="--progress-width: ${task.completion2025}%; animation-delay: ${0.2 + taskIndex * 0.1}s"
                                            ></div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <!-- 2025年期望目标完成情况 -->
                        <div>
                            <div class="flex justify-center items-center mb-4">
                                <h4 class="text-xl font-semibold text-warning flex items-center">
                                    <i class="fa fa-star mr-2 fa-xl"></i>
                                    2025年期望目标完成情况
                                </h4>
                            </div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
                                ${college.comparisonTasks.map((task, taskIndex) => `
                                    <div class="bg-white/5 rounded-lg p-3">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-sm truncate max-w-[80%] hover:whitespace-normal hover:text-wrap hover:bg-dark/70 p-1 rounded transition-all">${task.name.replace(/^\d+\.\s*/, '')}</span>
                                            <span class="text-xs font-semibold ${getProgressColor(task.completion2025)}">
                                                ${task.completion2025}%
                                            </span>
                                        </div>
                                        <div class="h-2 bg-white/10 rounded-full overflow-hidden border border-[#1292e0]/100">
                                            <div 
                                                class="h-full rounded-full progress-bar progress-bg"
                                                style="--progress-width: ${task.completion2025}%; animation-delay: ${0.2 + taskIndex * 0.1}s"
                                            ></div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        

                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // 初始化完成情况图表
        function initCompletionChart(colleges, canvasId = 'completion-chart') {
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            // 对学院按完成率降序排序
            const sortedColleges = [...colleges].sort((a, b) => {
                return calculateCompletionRate(b) - calculateCompletionRate(a);
            });
            
            // 生成标签和数据
            const labels = sortedColleges.map(c => {
                let name = c.shortName || c.name;
                // 为"材化学院（含国重实验室）"添加换行
                if (name.includes('（含国重实验室）')) {
                    return name.replace('（含国重实验室）', '\n（含国重实验室）');
                }
                return name;
            });
            const data = sortedColleges.map(c => calculateCompletionRate(c));
            
            // 销毁现有图表
            if (!window.completionCharts) {
                window.completionCharts = {};
            }
            if (window.completionCharts[canvasId]) {
                window.completionCharts[canvasId].destroy();
            }
            
            window.completionCharts[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '完成率 (%)',
                        data: data,
                        backgroundColor: data.map(value => {
                            if (value >= 90) return '#00B42A';
                            if (value >= 75) return '#165DFF';
                            if (value >= 60) return '#FF7D00';
                            return '#F53F3F';
                        }),
                        borderColor: data.map(value => {
                            if (value >= 90) return '#00B42A';
                            if (value >= 75) return '#165DFF';
                            if (value >= 60) return '#FF7D00';
                            return '#F53F3F';
                        }),
                        borderWidth: 1,
                        barPercentage: 0.5,
                        categoryPercentage: 0.6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y', // 设置为水平柱状图
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(29, 33, 41, 0.9)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: 'rgba(255, 255, 255, 0.1)',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return `完成率: ${context.raw}%`;
                                }
                            }
                        },
                        // 配置数据标签，在柱子右侧显示数字
                        datalabels: {
                            anchor: 'end',
                            align: 'end',
                            formatter: function(value) {
                                return value + '%';
                            },
                            color: 'rgba(255, 255, 255, 0.9)',
                            font: {
                                size: 12,
                                weight: 'bold'
                            },
                            offset: 8
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        y: {
                            position: 'left',
                            grid: {
                                display: false,
                                drawBorder: false
                            },
                            // 增加y轴标签的显示宽度
                            afterFit: function(axis) {
                                axis.width = Math.max(axis.width, 200);
                            },
                            ticks: {
                                color: '#ffffff', // 改为纯白色
                                font: {
                                    size: 16, // 增大字体大小
                                    lineHeight: 1.2,
                                    weight: 'normal'
                                },
                                padding: 10, // 增加内边距
                                maxRotation: 0, // 防止标签旋转
                                minRotation: 0,
                                // 启用多行标签显示
                                callback: function(value, index, values) {
                                    return labels[index].split('\n');
                                }
                            }
                        }
                    }
                }
            });
        }
        

        

        

        
        // 初始化赛道切换
        function initTabs() {
            // 获取综合分析板块
            const summarySection = document.getElementById('summary-section');
            
            // 合并情况赛道切换
            document.getElementById('science-tab').addEventListener('click', () => {
                // 重置所有标签状态
                document.querySelectorAll('[id$="-tab"]').forEach(btn => {
                    btn.classList.remove('bg-primary');
                    btn.classList.add('bg-white/10', 'hover:bg-white/20');
                });
                
                // 显示当前标签
                document.getElementById('science-tab').classList.add('bg-primary');
                document.getElementById('science-tab').classList.remove('bg-white/10', 'hover:bg-white/20');
                
                // 隐藏所有内容
                document.getElementById('science-content').classList.add('hidden');
                document.getElementById('humanity-content').classList.add('hidden');
                document.getElementById('platform-content').classList.add('hidden');
                document.getElementById('institution-content').classList.add('hidden');
                
                // 显示当前内容
                document.getElementById('science-content').classList.remove('hidden');
                
                // 显示综合分析板块
                summarySection.style.display = 'block';
                summarySection.style.opacity = '1';
                
                // 更新统计图表
                initCompletionRank(scienceColleges);
                initCompletionChart(scienceColleges, 'science-completion-chart');
            });
            
            document.getElementById('humanity-tab').addEventListener('click', () => {
                // 重置所有标签状态
                document.querySelectorAll('[id$="-tab"]').forEach(btn => {
                    btn.classList.remove('bg-primary');
                    btn.classList.add('bg-white/10', 'hover:bg-white/20');
                });
                
                // 显示当前标签
                document.getElementById('humanity-tab').classList.add('bg-primary');
                document.getElementById('humanity-tab').classList.remove('bg-white/10', 'hover:bg-white/20');
                
                // 隐藏所有内容
                document.getElementById('science-content').classList.add('hidden');
                document.getElementById('humanity-content').classList.add('hidden');
                document.getElementById('platform-content').classList.add('hidden');
                document.getElementById('institution-content').classList.add('hidden');
                
                // 显示当前内容
                document.getElementById('humanity-content').classList.remove('hidden');
                
                // 显示综合分析板块
                summarySection.style.display = 'block';
                summarySection.style.opacity = '1';
                
                // 更新统计图表
                initCompletionRank(humanityColleges);
                initCompletionChart(humanityColleges, 'humanity-completion-chart');
            });
            
            // 独立平台标签事件
            document.getElementById('platform-tab').addEventListener('click', () => {
                // 重置所有标签状态
                document.querySelectorAll('[id$="-tab"]').forEach(btn => {
                    btn.classList.remove('bg-primary');
                    btn.classList.add('bg-white/10', 'hover:bg-white/20');
                });
                
                // 显示当前标签
                document.getElementById('platform-tab').classList.add('bg-primary');
                document.getElementById('platform-tab').classList.remove('bg-white/10', 'hover:bg-white/20');
                
                // 隐藏所有内容
                document.getElementById('science-content').classList.add('hidden');
                document.getElementById('humanity-content').classList.add('hidden');
                document.getElementById('platform-content').classList.add('hidden');
                document.getElementById('institution-content').classList.add('hidden');
                
                // 显示当前内容
                document.getElementById('platform-content').classList.remove('hidden');
                
                // 隐藏综合分析板块
                summarySection.style.display = 'none';
                summarySection.style.opacity = '0';
                
                // 更新统计图表
                initCompletionRank(platformColleges);
                initCompletionChart(platformColleges);
            });
            
            // 新型研发机构标签事件
            document.getElementById('institution-tab').addEventListener('click', () => {
                // 重置所有标签状态
                document.querySelectorAll('[id$="-tab"]').forEach(btn => {
                    btn.classList.remove('bg-primary');
                    btn.classList.add('bg-white/10', 'hover:bg-white/20');
                });
                
                // 显示当前标签
                document.getElementById('institution-tab').classList.add('bg-primary');
                document.getElementById('institution-tab').classList.remove('bg-white/10', 'hover:bg-white/20');
                
                // 隐藏所有内容
                document.getElementById('science-content').classList.add('hidden');
                document.getElementById('humanity-content').classList.add('hidden');
                document.getElementById('platform-content').classList.add('hidden');
                document.getElementById('institution-content').classList.add('hidden');
                
                // 显示当前内容
                document.getElementById('institution-content').classList.remove('hidden');
                
                // 隐藏综合分析板块
                summarySection.style.display = 'none';
                summarySection.style.opacity = '0';
                
                // 更新统计图表
                initCompletionRank(institutionColleges);
                initCompletionChart(institutionColleges);
            });
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 更新时间
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // 初始设置合并section的显示状态
            const mergedSection = document.getElementById('merged-section');
            const summarySection = document.getElementById('summary-section');
            
            // 确保所有section默认可见
            mergedSection.style.display = 'block';
            mergedSection.style.opacity = '1';
            summarySection.style.display = 'block';
            summarySection.style.opacity = '1';
            
            // 初始化赛道切换
            initTabs();
            
            // 初始加载数据
            renderMergedCollegeCards(scienceColleges, 'science-content');
            renderMergedCollegeCards(humanityColleges, 'humanity-content');
            renderMergedCollegeCards(platformColleges, 'platform-content');
            renderMergedCollegeCards(institutionColleges, 'institution-content');
            
            // 初始化图表
            initCompletionChart(scienceColleges, 'science-completion-chart');
            initCompletionChart(humanityColleges, 'humanity-completion-chart');
            
            // 添加响应式调整
            window.addEventListener('resize', () => {
                initCompletionChart(scienceColleges, 'science-completion-chart');
                initCompletionChart(humanityColleges, 'humanity-completion-chart');
            });
        });
        
    </script>
    
    <!-- 回到顶部按钮 -->
    <button id="back-to-top" class="fixed bottom-8 right-8 bg-primary/80 hover:bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center transition-all duration-300 opacity-0 invisible z-50">
        <i class="fa fa-chevron-up"></i>
    </button>
    
    <script>
        // 回到顶部按钮功能
        const backToTopButton = document.getElementById('back-to-top');
        
        // 监听滚动事件
        window.addEventListener('scroll', () => {
            // 当页面滚动超过500px时显示按钮
            if (window.scrollY > 500) {
                backToTopButton.classList.remove('opacity-0', 'invisible');
                backToTopButton.classList.add('opacity-100', 'visible');
            } else {
                backToTopButton.classList.remove('opacity-100', 'visible');
                backToTopButton.classList.add('opacity-0', 'invisible');
            }
        });
        
        // 点击按钮回到顶部
        backToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    </script>
</body>
</html>